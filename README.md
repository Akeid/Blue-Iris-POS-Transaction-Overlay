# Blue-Iris-POS-Transaction-Overlay

A Python script that captures transaction data from Verifone Ruby & TOPAZ POS registers and displays it as an overlay in Blue Iris surveillance software.

## Overview

This tool allows you to connect your Verifone Point of Sale (POS) system to a Blue Iris camera system to display transaction data as an overlay on your surveillance footage. It captures the serial output from your POS terminal, formats the data, and makes it available for Blue Iris to display using its macro feature.

## Features

- Captures real-time transaction data from Verifone POS systems
- Supports Verifone Topaz, Sapphire, and Commander systems
- Creates daily transaction log files for record keeping
- Manages overlay display with configurable settings:
  - Maximum number of lines displayed
  - Transaction wipe time
- Timestamps all transactions
- Compatible with Blue Iris macro overlay system

## Requirements

- Python 3.x
- `pyserial` library
- Verifone POS system (Ruby, TOPAZ, Sapphire, or Commander)
- Blue Iris video surveillance software
- Serial connection between POS and computer running Blue Iris

## Installation

1. Clone the repository:
   ```
   git clone https://github.com/Akeid/Blue-Iris-POS-Transaction-Overlay.git
   ```

2. Install the required dependencies:
   ```
   python -m pip install pyserial
   ```

3. Configure the script by modifying the following variables:
   - `registerNUM` - Register identifier (default: "101")
   - `PORT_COM` - Serial port connection (default: "COM3")
   - `clipboardFile` - Output file name (default: "log_101.txt")
   - `maxOverlayLines` - Maximum lines to display (default: 9)
   - `wipeTime` - Time to display transaction before clearing (default: 4.5 seconds)

## Serial Connection

Only 2 pins need to be connected to the COM port:
- GND (Ground)
- RX (Receive)

The POS system needs to be configured to output DVR data via serial. For Verifone Topaz systems, you'll need to access the configuration options (Google "verifone topaz backdoor codes" to find access methods).

![Serial Pinout](https://i.imgur.com/ykmt4Uu.png)

## Connection Scheme

![Connection Diagram](https://i.imgur.com/P60xCx9.png)

## Usage

Run the script:
```
python serial_capture.py
```

The script will:
1. Connect to the POS system via serial port
2. Capture transaction data in real-time
3. Write transaction data to both a daily log file and an overlay display file
4. Clear the display after transactions are completed

## Blue Iris Integration

Configure a macro in Blue Iris to display the contents of the log file generated by the script:

1. In Blue Iris, go to Settings > Macros
2. Create a new macro that displays the contents of your clipboard log file
3. Go to your camera's video options
4. Choose "overlay" and enter the macro ID (ex. %1) to enable the macro

![Blue Iris Macro Setup](https://i.imgur.com/1kxxJyV.png)
![Blue Iris Camera Overlay](https://i.imgur.com/TTH6MPv.png)

## Customization

You can modify the script to:
- Change the number of lines displayed in the overlay
- Adjust the transaction display time
- Customize the transaction log format
- Add additional information to the overlay

## License

This project is licensed under the Creative Commons Attribution-NonCommercial 4.0 International License (CC BY-NC 4.0).

This means:
- You are free to share and adapt this code
- You must give appropriate credit to the original author (Akeid)
- You may not use the material for commercial purposes
- No additional restrictions â€” You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits

For more information, see the [full license text](https://creativecommons.org/licenses/by-nc/4.0/legalcode).

## Author

Created by [Akeid](https://github.com/Akeid) (2018)
